function Approval(){this.mySponsoredCount="",this.myExpenseCount="",this.ddUserID="",Object.defineProperty(this,"mySponsoredCount",{get:function(){return/^[0-9]*$/.test(mySponsoredCount)&&""!=mySponsoredCount?mySponsoredCount:mySponsoredCount="--"},set:function(e){e>99?mySponsoredCount="99+":e>=0&&e<=99&&(mySponsoredCount=e)}}),Object.defineProperty(this,"myExpenseCount",{get:function(){return/^[0-9]*$/.test(myExpenseCount)&&""!=myExpenseCount?myExpenseCount:myExpenseCount="--"},set:function(e){e>99?myExpenseCount="99+":e>=0&&e<=99&&(myExpenseCount=e)}}),this.config={mySponsoredCount:document.querySelector("#mySponsoredCount"),myExpenseCount:document.querySelector("#myExpenseCount"),content:document.getElementById("content"),footer:document.querySelector(".footer")}}Approval.prototype={throttle:function(e,t){clearTimeout(e.tId),e.tId=setTimeout(function(){e.call(t)},200)},get_ddUserID:function(){var e=sessionStorage.getItem("loginid");if(e)this.ddUserID=e;else{if(-1==window.location.href.indexOf("ddUserID"))throw $my.messageInfo.html("url错误").fadeIn("fast").delay("1000").fadeOut("slow"),new Error("url错误");var t=window.location.search;t=t.split("=")[1],this.ddUserID=t,sessionStorage.setItem("loginid",t)}},verification:function(){var e=this;if(""==e.ddUserID||null==e.ddUserID||"null"==e.ddUserID)return void $my.messageInfo.html("用户ID丢失").fadeIn("fast").delay("1000").fadeOut("slow");$.ajax({url:getRoothPath+"/ddExpenses/userController/login.do",data:{ddUserID:e.ddUserID},success:function(t){if("{}"===JSON.stringify(t))return $my.messageInfo.html("暂无数据").fadeIn("fast").delay("1000").fadeOut("slow"),!1;switch(t.status){case"true":var o,n;if(o=t.info,!o.length)return void $my.messageInfo.html("返回信息为空").fadeIn("fast").delay("1000").fadeOut("slow");n=o[0].userID,sessionStorage.setItem("ddUserID",n),e._getUnreadNum(n);break;case"failure":$my.messageInfo.html("登录错误").fadeIn("fast").delay("1000").fadeOut("slow")}}})},bindDom:function(){this.config.mySponsoredCount.innerHTML=this.mySponsoredCount,this.config.myExpenseCount.innerHTML=this.myExpenseCount},_getUnreadNum:function(e){var t=this;if(""==e||null==e||"null"==e)return void $my.messageInfo.html("用户ID丢失").fadeIn("fast").delay("1000").fadeOut("slow");$.ajax({url:getRoothPath+"/ddExpenses/expenseInfo/sum.do",data:{userID:e},success:function(e){if("{}"===JSON.stringify(e))return $my.messageInfo.html("暂无数据").fadeIn("fast").delay("1000").fadeOut("slow"),!1;switch(e.status){case"true":var o=e.info,n=o.myExpenseCount,s=o.mySponsoredCount;t.myExpenseCount=n,t.mySponsoredCount=s,t.bindDom();break;case"failure":$my.messageInfo.html("查询错误").fadeIn("fast").delay("1000").fadeOut("slow")}}})},buffer:function(){switch($(this).index()){case 0:window.location.href="myApproval.html";break;case 1:window.location.href="mySponser.html"}},bindEvents:function(){var e=this,t=e.config.content.querySelectorAll("li"),o=function(){window.location.href="sponsor.html"};Array.prototype.forEach.call(t,function(t,o){t.addEventListener("touchend",function(t){t.preventDefault(),t.stopPropagation(),e.throttle(e.buffer,this)},!1)}),this.config.footer.addEventListener("touchend",function(t){t.preventDefault(),t.stopPropagation(),e.throttle(o,this)},!1)},init:function(){this.get_ddUserID(),this.verification(),this.bindEvents()}};var approval=new Approval;$(function(){window.$my={messageInfo:$(".messageInfo")},approval.init(),function(){localStorage.removeItem("sessionTouchData_mySponser"),localStorage.removeItem("pageNum_mySponser"),localStorage.removeItem("dataCount_mySponser"),localStorage.removeItem("sessionTouchData_myApproval"),localStorage.removeItem("pageNum_myApproval"),localStorage.removeItem("dataCount_myApproval")}()});